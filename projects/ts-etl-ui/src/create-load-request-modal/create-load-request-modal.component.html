<h2 mat-dialog-title>Request Creation</h2>
<form [formGroup]="loadRequestCreationForm">
  <mat-dialog-content class="mat-typography">
    <div class="flex flex-col">
      <mat-form-field appearance="outline">
        <mat-label>Code System Name</mat-label>
        <mat-select placeholder="Code System Name" formControlName="codeSystemName">
          <mat-option value="">Select Code System</mat-option>
          <mat-option *ngFor="let CODE_SYSTEM_NAME of CODE_SYSTEM_NAMES"
                      [value]="CODE_SYSTEM_NAME">{{CODE_SYSTEM_NAME}}</mat-option>
        </mat-select>
      </mat-form-field>
      <ng-container *ngIf="loadRequestCreationForm.get('codeSystemName')?.getRawValue() as codeSystemName">
        <ng-container *ngIf="CODE_SYSTEM_REQUIRED_SOURCE_FILE[codeSystemName] as requiredFiles">
          <mat-list role="list" class="border-gray-50 border-2 border-solid mb-3" *ngIf="requiredFiles.length">
            <strong mat-subheader>Required Source files of {{codeSystemName}}</strong>
            <mat-list-item role="listitem" *ngFor="let requiredFile of requiredFiles">
              <div matListItemTitle>{{requiredFile}}</div>
            </mat-list-item>
          </mat-list>
        </ng-container>
      </ng-container>
      <mat-form-field appearance="fill">
        <mat-label>Request Subject</mat-label>
        <input matInput placeholder="Request Subject" formControlName="requestSubject">
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label for="sourcePathFile">Source File Path</mat-label>
        <input matInput formControlName="sourceFilePath">
        <mat-icon matSuffix (click)="fileUpload.click()" color="primary">attach_file</mat-icon>
        <input type="file" #fileUpload class="hidden" (change)="onFileSelected($event)" id="sourcePathFile"
               webkitdirectory directory>
        <mat-error *ngIf="loadRequestCreationForm.get('sourceFilePath')?.hasError('sourceFilePathError')">
          Please select source file from NLM server
        </mat-error>
      </mat-form-field>
      <div class="mb-5">
        <label id="load-request-type-label" for="load-request-type-radio">Request Type</label>
        <mat-radio-group aria-label-by="load-request-type-label" id="load-request-type-radio"
                         formControlName="requestType">
          <div class="ml-20">
            <mat-radio-button *ngFor="let LOAD_REQUEST_TYPE of LOAD_REQUEST_TYPES"
                              [value]="LOAD_REQUEST_TYPE"
                              class="block">{{LOAD_REQUEST_TYPE}}</mat-radio-button>
            <ng-container *ngIf="loadRequestCreationForm.get('type')?.value === 'Scheduler'">
              <mat-form-field appearance="outline" class="ml-3 dense-form-field">
                <mat-label>Scheduled Date</mat-label>
                <input matInput formControlName="scheduleDate" [matDatepicker]="picker"
                       [matDatepickerFilter]="futureDateFilter">
                <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
                <mat-datepicker #picker></mat-datepicker>
              </mat-form-field>
              <mat-form-field appearance="outline" class="dense-form-field">
                <mat-label>Scheduled time</mat-label>
                <mat-select formControlName="scheduleTime">
                  <mat-option value=""></mat-option>
                  <mat-option value="12:00 AM">12:00 AM</mat-option>
                  <mat-option value="12:30 AM">12:30 AM</mat-option>
                  <mat-option value="01:00 AM">1:00 AM</mat-option>
                  <mat-option value="01:30 AM">1:30 AM</mat-option>
                  <mat-option value="02:00 AM">2:00 AM</mat-option>
                  <mat-option value="02:30 AM">2:30 AM</mat-option>
                </mat-select>
              </mat-form-field>
            </ng-container>
          </div>
        </mat-radio-group>
      </div>
      <mat-form-field appearance="fill">
        <mat-label>Notification Email</mat-label>
        <input matInput placeholder="contact@nlm.nih.gov" formControlName="notificationEmail">
      </mat-form-field>
      <mat-form-field appearance="fill">
        <mat-label>Requester</mat-label>
        <input matInput placeholder="Requester" type="email" formControlName="requester">
      </mat-form-field>
      <mat-form-field appearance="fill">
        <mat-label>Request Date</mat-label>
        <input matInput placeholder="Request Date" formControlName="requestTime">
      </mat-form-field>
    </div>
  </mat-dialog-content>
  <mat-dialog-actions>
    <button mat-raised-button color="primary" mat-dialog-close>Cancel</button>
    <button mat-raised-button color="warn" type="submit" [disabled]="loadRequestCreationForm.invalid"
            [mat-dialog-close]="loadRequestCreationForm.getRawValue()">Submit
    </button>
  </mat-dialog-actions>
</form>

